# Sync Guide (Domeo No-Code Calculators)

Единый источник истины по синхронизации артефактов проекта.

## Принципы
- По каждой области — один источник истины в корне репозитория:
  - master_spec.md, admin_guide.md, data_import_guide_doors.md, spec_kp_formulas.md, state.md, roadmap.md, sync_guide.md.
- Дублей в `app/` быть не должно.
- Любые изменения логики фиксируются в master_spec.md и профильных гайдах тем же коммитом (см. DoD).
- Изменения сроков/вех отражаются синхронно в roadmap.md и state.md.

## Процесс
- Ежедневно: актуализируем state.md.
- Еженедельно: обновляем roadmap.md, сверяем admin_guide.md.
- По событию: меняем master_spec.md + связанный файл(ы) (Admin/Import/Spec КП).
- PR/Commit должен проходить проверки: `scripts/verify_truths.sh` и `scripts/spec_guard.py`.

## Таблица связей (фрагмент)
- master_spec.md ↔ admin_guide.md / data_import_guide_doors.md / spec_kp_formulas.md (логика/формулы/UX)
- roadmap.md ↔ state.md (сроки ↔ фактический статус)

## Истина для Roadmap/State

- Источники истины: корневые `roadmap.md` и `state.md`.  
- Дубли в `app/` запрещены. Любые файлы `app/roadmap.md`, `app/state.md` считаются legacy и подлежат удалению.  
- Если изменения касаются сроков, вех или статуса задач — они **обязательно** фиксируются в этих файлах **в том же MR**, где менялся код или документация.  
- Ссылки в других документах должны указывать только на корневые файлы.  
- При обнаружении дублей: содержимое переносится в корневые файлы, дубли удаляются в том же MR.  

## Истина для Roadmap/State

- Источники истины: корневые `roadmap.md` и `state.md`.  
- Дубли в `app/` запрещены. Любые файлы `app/roadmap.md`, `app/state.md` считаются legacy и подлежат удалению.  
- Если изменения касаются сроков, вех или статуса задач — они **обязательно** фиксируются в этих файлах **в том же MR**, где менялся код или документация.  
- Ссылки в других документах должны указывать только на корневые файлы.  
- При обнаружении дублей: содержимое переносится в корневые файлы, дубли удаляются в том же MR.  

## Синхронизация: изменения контрактов экспортов

Если меняется контракт экспортов (Doors):
- обновить: app/openapi.yaml, spec_kp_formulas.md, app/scripts/smoke.sh, roadmap.md, state.md
- все правки — в одном MR/коммите, чтобы сохранить непротиворечивость «истин».
