# üîç –û—Ç–ª–∞–¥–∫–∞ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

## üéØ **–ü—Ä–æ–±–ª–µ–º–∞:**
–°–≤—è–∑—å –º–µ–∂–¥—É —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø–µ—Ä–≤–æ–º –±–ª–æ–∫–µ, –≤—Ç–æ—Ä–æ–π –±–ª–æ–∫ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.

## üîç **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã:**

### **1. –û—à–∏–±–∫–∞ Prisma (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞):**
```
Unknown field `properties` for select statement on model `Product`
```
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ `properties_data`

### **2. –ü—Ä–æ–±–ª–µ–º–∞ —Å –∫—ç—à–µ–º:**
- API –≤–æ–∑–≤—Ä–∞—â–∞–ª –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å –æ—à–∏–±–∫–æ–π
- –ö—ç—à —Å–æ–¥–µ—Ä–∂–∞–ª —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –∫—ç—à –æ—á–∏—â–µ–Ω —á–µ—Ä–µ–∑ `/api/cache/clear`

### **3. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –ª–æ–≥–∏–∫–µ —Å–≤—è–∑–µ–π:**

#### **A. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:**
```typescript
// –í PageBuilder.tsx - handleConnectionData
const handleConnectionData = useCallback((sourceElementId: string, data: any) => {
  const outgoingConnections = (currentDocument.connections || []).filter(conn => 
    conn.sourceElementId === sourceElementId && conn.isActive
  );
  // ...
}, [currentDocument, selectedPage, handleUpdateElement]);
```

#### **B. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ PropertyFilter:**
```typescript
// –í PropertyFilter.tsx
if (element.props.filters && Object.keys(element.props.filters).length > 0) {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—ã–π API –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
  response = await fetch(`/api/catalog/products/filtered?${query.toString()}`);
}
```

#### **C. API –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤:**
```typescript
// –í /api/catalog/products/filtered/route.ts
const filteredProducts = products.filter(product => {
  const props = JSON.parse(product.properties_data);
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã
  for (const [filterPropertyName, filterValue] of Object.entries(filters)) {
    if (props[filterPropertyName] !== filterValue) {
      return false;
    }
  }
  
  return props.hasOwnProperty(propertyName);
});
```

## üß™ **–ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

### **1. –¢–µ—Å—Ç API (test-connections.html):**
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞
- üîÑ –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–æ–π—Å—Ç–≤
- üîÑ –¢–µ—Å—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- üîÑ –¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

### **2. –¢–µ—Å—Ç –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ:**
1. **–°–æ–∑–¥–∞—Ç—å –¥–≤–∞ –±–ª–æ–∫–∞ PropertyFilter**
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–≤—ã–π –±–ª–æ–∫:** –∫–∞—Ç–µ–≥–æ—Ä–∏—è "–ú–µ–∂–∫–æ–º–Ω–∞—Ç–Ω—ã–µ –¥–≤–µ—Ä–∏", —Å–≤–æ–π—Å—Ç–≤–æ "Domeo_–°—Ç–∏–ª—å Web"
3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ç–æ—Ä–æ–π –±–ª–æ–∫:** –∫–∞—Ç–µ–≥–æ—Ä–∏—è "–ú–µ–∂–∫–æ–º–Ω–∞—Ç–Ω—ã–µ –¥–≤–µ—Ä–∏", —Å–≤–æ–π—Å—Ç–≤–æ "Domeo_–ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ –¥–ª—è Web"
4. **–°–æ–∑–¥–∞—Ç—å —Å–≤—è–∑—å:** Ctrl+–∫–ª–∏–∫ –Ω–∞ –æ–±–∞ –±–ª–æ–∫–∞ ‚Üí "üîç –§–∏–ª—å—Ç—Ä—ã ‚Üí (–æ—Ç –ø–µ—Ä–≤–æ–≥–æ –∫–æ –≤—Ç–æ—Ä–æ–º—É)"
5. **–í—ã–±—Ä–∞—Ç—å —Å—Ç–∏–ª—å** –≤ –ø–µ—Ä–≤–æ–º –±–ª–æ–∫–µ
6. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ç–æ—Ä–æ–π –±–ª–æ–∫** - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –º–æ–¥–µ–ª–∏ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å—Ç–∏–ª—è

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
```
üîó handleConnectionData –≤—ã–∑–≤–∞–Ω–∞: {sourceElementId: "...", data: {...}}
üîç –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤: {...}
PropertyFilter: –ó–∞–ø—Ä–æ—Å –∫ API —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏: /api/catalog/products/filtered?...
PropertyFilter: –û—Ç–≤–µ—Ç API —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏: {...}
```

## üêõ **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –Ω–µ—Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å–≤—è–∑–µ–π:**

### **1. –°–≤—è–∑—å –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è:**
- –ú–µ–Ω—é —Å–≤—è–∑–∏ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ Ctrl+–∫–ª–∏–∫
- –°–≤—è–∑—å —Å–æ–∑–¥–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `currentDocument.connections`

### **2. –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è:**
- `handleConnectionData` –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
- –î–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è, –Ω–æ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- `onConnectionData` –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ PropertyFilter

### **3. PropertyFilter –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç:**
- `useEffect` –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `element.props.filters`
- API –∑–∞–ø—Ä–æ—Å –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É
- –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã, –Ω–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

### **4. API –ø—Ä–æ–±–ª–µ–º—ã:**
- `/api/catalog/products/filtered` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –î–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è, –Ω–æ –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ

## üîß **–®–∞–≥–∏ –æ—Ç–ª–∞–¥–∫–∏:**

### **1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API:**
```bash
# –¢–µ—Å—Ç –±–µ–∑ —Ñ–∏–ª—å—Ç—Ä–æ–≤
GET /api/catalog/products/filtered?categoryIds=cmg50xcgs001cv7mn0tdyk1wo&propertyName=Domeo_–ù–∞–∑–≤–∞–Ω–∏–µ%20–º–æ–¥–µ–ª–∏%20–¥–ª—è%20Web

# –¢–µ—Å—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º
GET /api/catalog/products/filtered?categoryIds=cmg50xcgs001cv7mn0tdyk1wo&propertyName=Domeo_–ù–∞–∑–≤–∞–Ω–∏–µ%20–º–æ–¥–µ–ª–∏%20–¥–ª—è%20Web&filters={"Domeo_–°—Ç–∏–ª—å Web":"–°–∫—Ä—ã—Ç–∞—è"}
```

### **2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞:**
- –û—à–∏–±–∫–∏ JavaScript
- –õ–æ–≥–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤
- –õ–æ–≥–∏ handleConnectionData

### **3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
- `currentDocument.connections` —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Å–≤—è–∑–∏
- `element.props.filters` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ª–∏ –≤ PropertyFilter
- `selectedElementIds` —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã

### **4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±–∞–∑–µ:**
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–≤–∞—Ä—ã —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Å—Ç–∏–ª–µ–º
SELECT id, sku, name, properties_data 
FROM product 
WHERE catalog_category_id = 'cmg50xcgs001cv7mn0tdyk1wo' 
AND properties_data LIKE '%"Domeo_–°—Ç–∏–ª—å Web":"–°–∫—Ä—ã—Ç–∞—è"%'
LIMIT 5;
```

## üìã **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å API** —á–µ—Ä–µ–∑ test-connections.html
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–≤—è–∑–µ–π** –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ
3. **–û—Ç–ª–∞–¥–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö** –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é PropertyFilter** –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
5. **–£–±–µ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ API** –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

---

**–¶–µ–ª—å: –ù–∞–π—Ç–∏ —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É, –ø–æ—á–µ–º—É —Å–≤—è–∑—å –º–µ–∂–¥—É —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç! üéØ**

