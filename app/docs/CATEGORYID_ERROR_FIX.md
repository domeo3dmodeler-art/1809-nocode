# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "categoryId is not defined"

## ‚úÖ **–û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!**

### üéØ **–ü—Ä–æ–±–ª–µ–º–∞:**
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∞ –ø–æ—è–≤–ª—è–ª–∞—Å—å –æ—à–∏–±–∫–∞:
**"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–∞: categoryId is not defined"**

### üîç **–ü—Ä–∏—á–∏–Ω–∞ –æ—à–∏–±–∫–∏:**
–í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `DataUpload` —Ñ—É–Ω–∫—Ü–∏—è `handleCatalogComplete` –ø—ã—Ç–∞–ª–∞—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `categoryId`, –Ω–æ –æ–Ω–∞ –Ω–µ –±—ã–ª–∞ –ø–µ—Ä–µ–¥–∞–Ω–∞ –∫–∞–∫ –ø—Ä–æ–ø—Å –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞.

### üõ†Ô∏è **–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

#### **1. –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–ø—Å categoryId –≤ DataUploadProps:**
```typescript
interface DataUploadProps {
  categoryId?: string; // ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
  onPriceListLoaded: (data: PriceListData) => void;
  onPhotosLoaded: (data: PhotoData) => void;
  onComplete: () => void;
  categoryData?: any; // –î–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–∞—Ç–∞–ª–æ–≥—É
}
```

#### **2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
```typescript
export default function DataUpload({ 
  categoryId, 
  onPriceListLoaded, 
  onPhotosLoaded, 
  onComplete, 
  categoryData 
}: DataUploadProps) {
  // –¢–µ–ø–µ—Ä—å categoryId –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
}
```

#### **3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ categoryId –∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:**
```typescript
// app/admin/categories/builder/page.tsx
<DataUpload
  categoryId={categoryData?.id}  // –ù–û–í–´–ô –ü–†–û–ü–°
  onPriceListLoaded={handlePriceListLoaded}
  onPhotosLoaded={handlePhotosLoaded}
  onComplete={handleDataComplete}
/>
```

### üîÑ **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

#### **1. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö:**
```
–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (page.tsx)
  ‚Üì –ø–µ—Ä–µ–¥–∞–µ—Ç categoryId
DataUpload –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
  ‚Üì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç categoryId –≤ API –∑–∞–ø—Ä–æ—Å–∞—Ö
API /admin/categories/[id]
  ‚Üì —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ë–î
```

#### **2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö:**
```typescript
const handleCatalogComplete = async () => {
  try {
    // –¢–µ–ø–µ—Ä—å categoryId –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –ø—Ä–æ–ø—Å–æ–≤
    if (categoryId && selectedCatalogCategoryId) {
      const response = await fetch(`/api/admin/categories/${categoryId}`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          catalogCategoryIds: [selectedCatalogCategoryId]
        }),
      });
      // ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
    }
  } catch (error) {
    // ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  }
};
```

#### **3. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π:**
- ‚úÖ `handlePropertyMappingComplete` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `categoryId`
- ‚úÖ `handlePhotoMappingComplete` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `categoryId`

### üé® **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

#### **1. –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ API:**
- ‚úÖ **categoryId –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è** –≤ API –∑–∞–ø—Ä–æ—Å—ã
- ‚úÖ **–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- ‚úÖ **–ù–µ—Ç –æ—à–∏–±–æ–∫** –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏

#### **2. –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —à–∞–≥–∏:**
- ‚úÖ **–ö–∞—Ç–∞–ª–æ–≥** - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º ID
- ‚úÖ **–°–≤–æ–π—Å—Ç–≤–∞** - —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º ID
- ‚úÖ **–§–æ—Ç–æ** - —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º ID

#### **3. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è** categoryId –ø–µ—Ä–µ–¥ API –∑–∞–ø—Ä–æ—Å–∞–º–∏
- ‚úÖ **Graceful degradation** –µ—Å–ª–∏ ID –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –æ—à–∏–±–∫–∏** –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### üöÄ **URL –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```
http://localhost:3000/admin/categories/builder?id=cmg3ofl8400006yfg8hny20vb
```

### üìã **–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

#### **–¢–µ—Å—Ç 1: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–∞—Ç–∞–ª–æ–≥–∞**
1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ —à–∞–≥—É "–î–∞–Ω–Ω—ã–µ"**
2. **–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫–∞—Ç–∞–ª–æ–≥–∞** (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–î–≤–µ—Ä–∏ ‚Üí –ú–µ–∂–∫–æ–º–Ω–∞—Ç–Ω—ã–µ –¥–≤–µ—Ä–∏")
3. **–ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"**
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
   - ‚úÖ –ù–ï–¢ –æ—à–∏–±–∫–∏ "categoryId is not defined"
   - ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–∞—Ç–∞–ª–æ–≥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
   - ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É

#### **–¢–µ—Å—Ç 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤**
1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–∞–ø–ø–∏–Ω–≥ —Å–≤–æ–π—Å—Ç–≤**
2. **–ù–∞–∂–º–∏—Ç–µ "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"**
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
   - ‚úÖ –ù–ï–¢ –æ—à–∏–±–∫–∏ "categoryId is not defined"
   - ‚úÖ –ú–∞–ø–ø–∏–Ω–≥ —Å–≤–æ–π—Å—Ç–≤ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î
   - ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É

#### **–¢–µ—Å—Ç 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π**
1. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏**
2. **–ù–∞–∂–º–∏—Ç–µ "–ó–∞–≤–µ—Ä—à–∏—Ç—å"**
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
   - ‚úÖ –ù–ï–¢ –æ—à–∏–±–∫–∏ "categoryId is not defined"
   - ‚úÖ –î–∞–Ω–Ω—ã–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
   - ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –∫ —à–∞–≥—É "–ì–æ—Ç–æ–≤–æ"

#### **–¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î**
1. **–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ª—é–±–æ–π —à–∞–≥**
2. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É**
3. **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é**
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç**:
   - ‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –≤ –ë–î
   - ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ –ø–æ—Ç–µ—Ä—è–ª—Å—è
   - ‚úÖ –ú–æ–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞

### üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**

#### **1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–ø—Å–æ–≤:**
```typescript
// DataUpload –ø–æ–ª—É—á–∞–µ—Ç:
{
  categoryId: "cmg3ofl8400006yfg8hny20vb",  // ID –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  onPriceListLoaded: function,               // –ö–æ–ª–±—ç–∫ –¥–ª—è –ø—Ä–∞–π—Å-–ª–∏—Å—Ç–∞
  onPhotosLoaded: function,                  // –ö–æ–ª–±—ç–∫ –¥–ª—è —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
  onComplete: function,                      // –ö–æ–ª–±—ç–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
  categoryData: object                       // –î–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
}
```

#### **2. API –∑–∞–ø—Ä–æ—Å—ã:**
```typescript
// –í—Å–µ API –∑–∞–ø—Ä–æ—Å—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π categoryId
PUT /api/admin/categories/cmg3ofl8400006yfg8hny20vb
{
  "catalogCategoryIds": ["selected_category_id"],
  "propertyMapping": [...],
  "photoMapping": {...},
  "photoData": {...}
}
```

#### **3. –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è categoryId –ø–µ—Ä–µ–¥ API –∑–∞–ø—Ä–æ—Å–∞–º–∏
if (categoryId && selectedCatalogCategoryId) {
  // –í—ã–ø–æ–ª–Ω—è–µ–º API –∑–∞–ø—Ä–æ—Å
} else {
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–ø—Ä–æ—Å
}
```

### üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

**–û—à–∏–±–∫–∞ "categoryId is not defined" –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!**

- ‚úÖ **categoryId –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è** –∫–∞–∫ –ø—Ä–æ–ø—Å –≤ DataUpload
- ‚úÖ **API –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è** –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- ‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —à–∞–≥–∏** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏** –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫–∏
- ‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

**–°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —à–∞–≥–∞—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ!** üîß‚ú®




