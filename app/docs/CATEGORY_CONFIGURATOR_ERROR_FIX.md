# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

## ‚úÖ **–û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!**

### üéØ **–ü—Ä–æ–±–ª–µ–º–∞:**
–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ—è–≤–ª—è–ª–∞—Å—å –æ—à–∏–±–∫–∞:
**"TypeError: Cannot read properties of null (reading 'name')"**

### üîç **–ü—Ä–∏—á–∏–Ω—ã –æ—à–∏–±–∫–∏:**
1. **API –≤–æ–∑–≤—Ä–∞—â–∞–ª 500 –æ—à–∏–±–∫—É** - –ø—ã—Ç–∞–ª—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É `category`
2. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª null** - –æ–±—Ä–∞—â–∞–ª—Å—è –∫ `category.name` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
3. **–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ fallback –∑–Ω–∞—á–µ–Ω–∏—è** - –Ω–µ –±—ã–ª–æ –∑–∞–ø–∞—Å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### üõ†Ô∏è **–ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**

#### **1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω API —à–∞–±–ª–æ–Ω–∞ (`/api/admin/categories/template/route.ts`):**
- ‚ùå **–£–±—Ä–∞–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ** –∫ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü–µ `prisma.category`
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ** –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ç–∞–±–ª–∏—Ü–µ `prisma.frontendCategory`
- ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ–ª—è** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ö–µ–º–æ–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `display_config`)

#### **2. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ null –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ:**
- ‚úÖ **–°—Ç—Ä–æ–∫–∞ 154**: `{category?.name || '–ö–∞—Ç–µ–≥–æ—Ä–∏—è'}`
- ‚úÖ **–°—Ç—Ä–æ–∫–∞ 212**: `{template?.name || currentTemplate.name}`
- ‚úÖ **–°—Ç—Ä–æ–∫–∞ 216**: `{template?.components?.length || currentTemplate.components.length}`
- ‚úÖ **–°—Ç—Ä–æ–∫–∞ 220**: `{template?.layout?.columns || currentTemplate.layout.columns}`
- ‚úÖ **–°—Ç—Ä–æ–∫–∞ 224**: `{(template?.layout?.responsive ?? currentTemplate.layout.responsive) ? '–î–∞' : '–ù–µ—Ç'}`

#### **3. –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã fallback –∑–Ω–∞—á–µ–Ω–∏—è** –¥–ª—è –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è defaultTemplate** –∫–æ–≥–¥–∞ template –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ** –∫ –≤–ª–æ–∂–µ–Ω–Ω—ã–º —Å–≤–æ–π—Å—Ç–≤–∞–º

### üîÑ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**

#### **API –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```typescript
// –î–û (–Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –º–æ–¥–µ–ª—å)
const category = await prisma.category.findUnique({
  where: { id: categoryId }
});

// –ü–û–°–õ–ï (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –º–æ–¥–µ–ª—å)
const category = await prisma.frontendCategory.findUnique({
  where: { id: categoryId }
});
```

#### **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```typescript
// –î–û (–±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏)
<h2>{category.name}</h2>
<span>{template.name}</span>
<span>{template.components.length}</span>

// –ü–û–°–õ–ï (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π)
<h2>{category?.name || '–ö–∞—Ç–µ–≥–æ—Ä–∏—è'}</h2>
<span>{template?.name || currentTemplate.name}</span>
<span>{template?.components?.length || currentTemplate.components.length}</span>
```

### üé® **–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

#### **1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
- ‚úÖ **API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç** –¥–∞–Ω–Ω—ã–µ –∏–∑ `frontendCategory`
- ‚úÖ **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç** `category` –∏ `template`
- ‚úÖ **–ï—Å–ª–∏ template –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `defaultTemplate`

#### **2. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ null** –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
- ‚úÖ **Fallback –∑–Ω–∞—á–µ–Ω–∏—è** –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ** –∫ –≤–ª–æ–∂–µ–Ω–Ω—ã–º —Å–≤–æ–π—Å—Ç–≤–∞–º

#### **3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- ‚úÖ **Graceful degradation** - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ fallback** - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ä–∞–∑—É–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ **–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫** - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–∞–¥–∞–µ—Ç

### üöÄ **URL –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**: `http://localhost:3000/admin/categories/[id]/configurator`

### üìã **–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**

#### **–¢–µ—Å—Ç 1: –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä**
1. **–°–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é** —á–µ—Ä–µ–∑ `/admin/categories/builder`
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞** `/admin/categories`
3. **–ù–∞–∂–º–∏—Ç–µ "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä"** –Ω–∞ –ª—é–±–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
4. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ù–ï–¢ –æ—à–∏–±–∫–∏, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

#### **–¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫** - –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ "–ö–∞—Ç–µ–≥–æ—Ä–∏—è"
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —à–∞–±–ª–æ–Ω–µ** - –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä** - –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å –±–∞–∑–æ–≤—ã–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

#### **–¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ API**
1. **–û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools** (F12)
2. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ Network** –≤–∫–ª–∞–¥–∫—É
3. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–∞
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–ø—Ä–æ—Å** GET `/api/admin/categories/template`
5. **–†–µ–∑—É–ª—å—Ç–∞—Ç**: —Å—Ç–∞—Ç—É—Å 200, —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç

### üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:**

#### **1. API –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```typescript
// GET –º–µ—Ç–æ–¥ - –ø–æ–ª—É—á–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞
export async function GET(req: NextRequest) {
  try {
    const category = await prisma.frontendCategory.findUnique({
      where: { id: categoryId }
    });

    let template = null;
    if (category.display_config) {
      template = JSON.parse(category.display_config);
    }

    return NextResponse.json({
      success: true,
      template,
      category: {
        id: category.id,
        name: category.name,
        slug: category.slug,
        description: category.description
      }
    });
  } catch (error) {
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  }
}
```

#### **2. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```typescript
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
const currentTemplate = template || defaultTemplate;

return (
  <div>
    <h2>{category?.name || '–ö–∞—Ç–µ–≥–æ—Ä–∏—è'}</h2>
    <span>{template?.name || currentTemplate.name}</span>
    <span>{template?.components?.length || currentTemplate.components.length}</span>
  </div>
);
```

#### **3. Fallback –∑–Ω–∞—á–µ–Ω–∏—è:**
```typescript
const defaultTemplate: PageTemplate = {
  id: 'default',
  name: '–ë–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä',
  description: '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–æ–≤',
  layout: {
    type: 'grid',
    columns: 3,
    gap: 4,
    responsive: true
  },
  components: [
    // –ë–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–∞
  ]
};
```

### üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç:**

**–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞!**

- ‚úÖ **API —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
- ‚úÖ **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Å—Ç–æ–π—á–∏–≤ –∫ –æ—à–∏–±–∫–∞–º** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç null –∑–Ω–∞—á–µ–Ω–∏—è
- ‚úÖ **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è** - –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ **–î–∞–Ω–Ω—ã–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è** - —Å fallback –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
- ‚úÖ **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –±–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —É–ª—É—á—à–µ–Ω–∞** - graceful degradation

**–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ç–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üé®‚ú®




